# Implementation Plan: Beautique Store Frontend - Phase 1

**Branch**: `002-beautique-frontend` | **Date**: 2026-01-19 | **Spec**: [spec.md](./spec.md)
**Input**: Feature specification from `/specs/002-beautique-frontend/spec.md`

## Summary

Build a customer-facing e-commerce website and admin panel for Beautique Store using Next.js 16 App Router with TypeScript. The frontend integrates with the existing FastAPI backend for product browsing, order creation, order tracking, and admin management. Cart and wishlist persist in localStorage. Admin authentication uses JWT tokens. Payment is handled manually via WhatsApp verification (NO COD per constitution).

---

## Technical Context

**Language/Version**: TypeScript 5.x, Node.js 20+
**Primary Dependencies**: Next.js 16 (App Router), React 19, Tailwind CSS, shadcn/ui, Zod, React Hook Form
**Storage**: localStorage (cart, wishlist, admin token)
**Testing**: Manual testing (Playwright/Jest deferred to Phase 2)
**Target Platform**: Web (Desktop, Tablet, Mobile responsive)
**Project Type**: Web application (frontend only, backend already exists)
**Performance Goals**: <3s initial load, <500ms form validation feedback
**Constraints**: Must integrate with existing backend API at http://localhost:8000
**Scale/Scope**: ~20 pages (14 customer + 6 admin), ~30 components

---

## Constitution Check

*GATE: Must pass before Phase 0 research. Re-check after Phase 1 design.*

| Principle | Status | Implementation Notes |
|-----------|--------|---------------------|
| I. Backend-First Development | PASS | Backend already implemented and tested; frontend consumes existing API |
| II. Manual Payment Workflow | PASS | Implementing Easypaisa/Meezan Bank/International Bank with WhatsApp verification; NO COD |
| III. No Customer Authentication | PASS | Cart/wishlist in localStorage; order tracking via Order ID + phone |
| IV. International-Ready Design | PASS | Phone validation 10-15 digits; address fields not Pakistan-specific |
| V. Professional UI Standards | PASS | shadcn/ui + Tailwind; Next.js Image optimization; mobile-responsive |
| VI. MCP Context 7 Compliance | PASS | Next.js 16 App Router; TypeScript strict mode; latest patterns |
| VII. Minimal Viable Scope | PASS | Core e-commerce only; no reviews/ratings/promotions |

**Constitution Compliance**: All 7 principles PASS. No violations to justify.

---

## Project Structure

### Documentation (this feature)

```text
specs/002-beautique-frontend/
├── plan.md              # This file
├── research.md          # Technology decisions and patterns
├── data-model.md        # TypeScript type definitions
├── quickstart.md        # Project setup instructions
├── contracts/           # API endpoint documentation
│   └── api-endpoints.md
└── tasks.md             # To be generated by /sp.tasks
```

### Source Code (repository root)

```text
frontend/
├── app/
│   ├── layout.tsx              # Root layout (Navbar, Footer, Providers)
│   ├── page.tsx                # Home page
│   ├── loading.tsx             # Global loading UI
│   ├── error.tsx               # Global error boundary
│   ├── not-found.tsx           # 404 page
│   │
│   ├── products/
│   │   ├── page.tsx            # All products listing
│   │   ├── [category]/
│   │   │   └── page.tsx        # Category-filtered products
│   │   └── [id]/
│   │       └── page.tsx        # Product detail
│   │
│   ├── cart/
│   │   └── page.tsx            # Shopping cart
│   │
│   ├── checkout/
│   │   └── page.tsx            # Checkout form
│   │
│   ├── order-confirmation/
│   │   └── [orderId]/
│   │       └── page.tsx        # Order confirmation with payment instructions
│   │
│   ├── track-order/
│   │   └── page.tsx            # Order tracking form and results
│   │
│   ├── wishlist/
│   │   └── page.tsx            # Saved products
│   │
│   ├── about/
│   │   └── page.tsx            # About us + Google Maps
│   │
│   ├── legal/
│   │   └── page.tsx            # Privacy Policy + Terms of Service (tabs)
│   │
│   ├── support/
│   │   └── page.tsx            # FAQ accordion + Contact form
│   │
│   └── admin/
│       ├── layout.tsx          # Admin layout with auth protection
│       ├── login/
│       │   └── page.tsx        # Admin login
│       ├── dashboard/
│       │   └── page.tsx        # Analytics dashboard
│       ├── products/
│       │   ├── page.tsx        # Product list
│       │   ├── new/
│       │   │   └── page.tsx    # Create product
│       │   └── [id]/
│       │       └── edit/
│       │           └── page.tsx # Edit product
│       ├── orders/
│       │   ├── page.tsx        # Order list
│       │   └── [id]/
│       │       └── page.tsx    # Order detail + status update
│       └── settings/
│           └── page.tsx        # Change password
│
├── components/
│   ├── ui/                     # shadcn/ui components (auto-generated)
│   │
│   ├── layout/
│   │   ├── Navbar.tsx          # Navigation with categories, search, cart, wishlist
│   │   ├── Footer.tsx          # Links, social media, payment methods
│   │   └── AdminSidebar.tsx    # Admin navigation
│   │
│   ├── product/
│   │   ├── ProductCard.tsx     # Product display card
│   │   ├── ProductGrid.tsx     # Responsive product grid
│   │   ├── ProductFilter.tsx   # Filter sidebar
│   │   └── ImageGallery.tsx    # Product images with thumbnails
│   │
│   ├── cart/
│   │   ├── CartItem.tsx        # Single cart item with controls
│   │   └── CartSummary.tsx     # Cart totals
│   │
│   ├── forms/
│   │   ├── CheckoutForm.tsx    # Customer checkout form
│   │   ├── LoginForm.tsx       # Admin login form
│   │   ├── ProductForm.tsx     # Product create/edit form
│   │   ├── ContactForm.tsx     # Contact us form
│   │   └── TrackOrderForm.tsx  # Order tracking form
│   │
│   └── common/
│       ├── SearchBar.tsx       # Product search
│       ├── Pagination.tsx      # Page navigation
│       ├── LoadingSpinner.tsx  # Loading indicator
│       └── ErrorMessage.tsx    # Error display
│
├── context/
│   ├── CartContext.tsx         # Cart state with localStorage
│   ├── WishlistContext.tsx     # Wishlist state with localStorage
│   └── AuthContext.tsx         # Admin auth state
│
├── hooks/
│   ├── useCart.ts              # Cart context hook
│   ├── useWishlist.ts          # Wishlist context hook
│   ├── useAuth.ts              # Auth context hook
│   └── useApiError.ts          # API error handling
│
├── lib/
│   ├── api.ts                  # API client with fetch wrapper
│   ├── validation.ts           # Zod schemas
│   ├── utils.ts                # Helper functions (cn, formatPrice)
│   └── constants.ts            # Categories, payment methods, storage keys
│
├── types/
│   ├── product.ts              # Product types
│   ├── order.ts                # Order types
│   ├── admin.ts                # Admin types
│   ├── cart.ts                 # Cart types
│   ├── wishlist.ts             # Wishlist types
│   └── api.ts                  # API response types
│
├── public/
│   ├── images/
│   │   └── logo.svg
│   └── icons/
│
├── .env.local                  # Environment variables
├── next.config.js              # Next.js configuration
├── tailwind.config.ts          # Tailwind configuration
├── tsconfig.json               # TypeScript configuration
└── package.json
```

**Structure Decision**: Web application with frontend directory at repository root (alongside existing backend). App Router with file-based routing. Components organized by feature domain.

---

## Implementation Phases

### Phase 0: Project Initialization (Blocking)

**Objective**: Set up Next.js project with all dependencies and base configuration.

**Tasks**:
1. Create Next.js 16 project with TypeScript, Tailwind, ESLint, App Router
2. Install dependencies: zod, react-hook-form, @hookform/resolvers, lucide-react, clsx, tailwind-merge
3. Initialize shadcn/ui and add required components
4. Configure next.config.js for Cloudinary images
5. Create environment variables (.env.local)
6. Set up TypeScript types (types/*.ts)
7. Create utility functions (lib/utils.ts, lib/constants.ts)
8. Implement API client (lib/api.ts)
9. Create Zod validation schemas (lib/validation.ts)

**Deliverables**:
- Working Next.js project that runs without errors
- All shadcn/ui components available
- API client ready for use
- Type definitions complete

---

### Phase 1: Core Infrastructure (Blocking)

**Objective**: Build foundational layout and state management.

**Tasks**:
1. Implement CartContext with localStorage persistence
2. Implement WishlistContext with localStorage persistence
3. Implement AuthContext for admin JWT management
4. Create Navbar component (logo, categories, search, wishlist, cart)
5. Create Footer component (links, social, payment info)
6. Create root layout with providers
7. Implement loading and error states
8. Create common components (Pagination, LoadingSpinner, ErrorMessage)

**Deliverables**:
- Functional cart and wishlist that persist across sessions
- Complete layout visible on all pages
- State management working end-to-end

---

### Phase 2: Customer Pages - Browse & Purchase (P1)

**Objective**: Implement the core purchase flow.

**Tasks**:
1. **Home Page**:
   - Hero section with featured image
   - Featured products grid (bestsellers from API)
   - Category cards linking to category pages

2. **Products Listing**:
   - ProductCard component
   - ProductGrid component with responsive layout
   - ProductFilter sidebar (category, price range, size, color)
   - Search integration
   - Pagination

3. **Category Pages**:
   - Dynamic route with category filter
   - Same components as products listing

4. **Product Detail Page**:
   - ImageGallery component with thumbnails
   - Product info (name, price, description)
   - Size and color selectors
   - Add to cart functionality
   - Add to wishlist functionality

5. **Cart Page**:
   - CartItem component with quantity controls
   - CartSummary with totals
   - Proceed to checkout button
   - Empty cart state

6. **Checkout Page**:
   - CheckoutForm with Zod validation
   - Payment method selection (Easypaisa, Meezan Bank, International Bank)
   - Order summary
   - Submit order to API

7. **Order Confirmation Page**:
   - Order ID display
   - Order summary
   - Payment instructions based on selected method
   - WhatsApp link for payment screenshot

**Deliverables**:
- Complete purchase flow from browse to order confirmation
- Cart functionality with localStorage persistence
- All forms validated with Zod

---

### Phase 3: Admin Panel - Core Features (P1)

**Objective**: Implement admin authentication and CRUD operations.

**Tasks**:
1. **Admin Layout**:
   - Auth protection (redirect to login if not authenticated)
   - AdminSidebar navigation
   - Responsive design (mobile-friendly)

2. **Login Page**:
   - LoginForm with validation
   - JWT storage on success
   - Error handling for invalid credentials

3. **Dashboard**:
   - Fetch analytics from API
   - Display metrics (total orders, revenue, pending payments)
   - Orders by status breakdown

4. **Products Management**:
   - Products list with pagination
   - Add product form with image upload
   - Edit product form
   - Soft delete functionality

5. **Orders Management**:
   - Orders list with filters (payment status, order status)
   - Order detail view
   - Status update functionality
   - Tracking notes input
   - CSV export button

6. **Settings**:
   - Password change form

**Deliverables**:
- Secure admin panel with JWT authentication
- Full product CRUD with image upload
- Order management with status updates
- CSV export functionality

---

### Phase 4: Secondary Features (P2)

**Objective**: Implement order tracking and search/filter enhancements.

**Tasks**:
1. **Order Tracking Page**:
   - TrackOrderForm (Order ID + Phone)
   - Display order status, items, delivery info
   - Error handling for not found

2. **Search Enhancement**:
   - Debounced search input
   - Search results page integration
   - Clear search functionality

3. **Filter Improvements**:
   - URL-based filter state
   - Clear all filters button
   - Filter count indicators

**Deliverables**:
- Working order tracking
- Enhanced search and filter UX

---

### Phase 5: Nice-to-Have Features (P3)

**Objective**: Implement wishlist and informational pages.

**Tasks**:
1. **Wishlist Page**:
   - Display saved products
   - Remove from wishlist
   - Add to cart from wishlist
   - Empty state

2. **About Page**:
   - Store description content
   - Google Maps embed (iframe)

3. **Legal Page**:
   - Tabbed interface
   - Privacy Policy content
   - Terms of Service content

4. **Support Page**:
   - FAQ accordion (expandable)
   - Contact form with validation
   - Contact information display

**Deliverables**:
- Complete wishlist functionality
- All informational pages

---

### Phase 6: Polish & Testing

**Objective**: Ensure quality and responsiveness.

**Tasks**:
1. Responsive design testing (320px, 768px, 1024px+)
2. Form validation edge cases
3. API error handling verification
4. Loading state implementation
5. Toast notification integration
6. Console error cleanup
7. Performance optimization (lazy loading, image optimization)
8. Cross-browser testing

**Deliverables**:
- All pages responsive
- No console errors
- All success criteria met

---

## Architectural Decisions

### ADR-001: State Management - React Context over Redux/Zustand

**Decision**: Use React Context API with useReducer for cart/wishlist state.

**Rationale**:
- Sufficient for localStorage-based state without server sync
- No additional dependencies
- Constitution principle VII (Minimal Viable Scope)

**Alternatives Rejected**:
- Redux: Overkill for client-only state
- Zustand: Unnecessary dependency for simple state

### ADR-002: API Client - Native fetch over Axios

**Decision**: Use native fetch with custom wrapper.

**Rationale**:
- Next.js optimizes native fetch with caching
- No additional dependency
- Thin wrapper provides error handling

**Alternatives Rejected**:
- Axios: Additional dependency without significant benefit
- TanStack Query: Adds complexity for simple CRUD

### ADR-003: Form Handling - React Hook Form + Zod

**Decision**: Use React Hook Form with Zod schema validation.

**Rationale**:
- Best DX with minimal re-renders
- Type-safe validation matching backend Pydantic schemas
- Constitution requirement for frontend validation

### ADR-004: Admin Auth - localStorage JWT

**Decision**: Store JWT token in localStorage.

**Rationale**:
- Simpler implementation for Phase 1
- Adequate security for admin panel
- httpOnly cookies can be added in Phase 2 if needed

**Trade-off**: Less secure than httpOnly cookies, acceptable for Phase 1.

### ADR-005: Combined Pages - /legal and /support

**Decision**: Combine related content into single pages with tabs/sections.

**Rationale**:
- Reduces navigation complexity
- Better UX with fewer clicks
- Matches typical e-commerce patterns

**Implementation**:
- /legal: Privacy Policy + Terms of Service (tabs)
- /support: FAQ + Contact (sections)

---

## Risk Analysis

| Risk | Impact | Mitigation |
|------|--------|------------|
| Backend API unavailable | High | Implement proper error states; show retry options |
| localStorage full/disabled | Medium | Graceful degradation; inform user data may not persist |
| Image upload failures | Medium | Display errors; preserve form data; allow retry |
| Session expiry during form | Medium | Preserve form data; redirect to login; restore after auth |

---

## Success Criteria Mapping

| Success Criteria | Implementation |
|-----------------|----------------|
| SC-001: Checkout in <5 min | Optimized flow, minimal steps |
| SC-002: Pages load <3s | Next.js optimization, lazy loading |
| SC-003: 95% successful add-to-cart | Proper error handling, loading states |
| SC-004: Tracking <2s response | Direct API call, loading indicator |
| SC-005: Cart/wishlist persistence | localStorage with proper serialization |
| SC-006: Validation <500ms | Client-side Zod validation |
| SC-007: Admin login <3s | Direct API call, redirect on success |
| SC-008: Product creation <3 min | Streamlined form, image upload |
| SC-009: Status update ≤2 clicks | Quick action buttons on list |
| SC-010: CSV export <5s | Backend handles generation |
| SC-011: Responsive design | Tailwind breakpoints, mobile-first |
| SC-012: No console errors | Proper error boundaries, logging |
| SC-013: Admin route protection | AuthContext, layout redirect |

---

## Dependencies

| Dependency | Purpose | Version |
|------------|---------|---------|
| next | Framework | ^15.0.0 (latest stable) |
| react | UI Library | ^19.0.0 |
| typescript | Type safety | ^5.0.0 |
| tailwindcss | Styling | ^3.4.0 |
| zod | Validation | ^3.23.0 |
| react-hook-form | Forms | ^7.53.0 |
| @hookform/resolvers | Zod integration | ^3.9.0 |
| lucide-react | Icons | ^0.460.0 |
| clsx | Class utilities | ^2.1.0 |
| tailwind-merge | Class merging | ^2.5.0 |
| @radix-ui/* | shadcn/ui base | Various |

---

## Environment Variables

```bash
# .env.local
NEXT_PUBLIC_API_URL=http://localhost:8000
NEXT_PUBLIC_SITE_URL=http://localhost:3000
```

---

## Next Steps

1. Run `/sp.tasks` to generate detailed task breakdown
2. Execute Phase 0 (Project Initialization)
3. Follow phase sequence for implementation

---

## Spec Alignment Note

**IMPORTANT**: The specification mentions "Cash on Delivery payment instructions" but the constitution explicitly states "NO Cash on Delivery (COD) in Phase 1". The implementation follows the constitution, using manual payment verification via WhatsApp with Easypaisa, Meezan Bank, and International Bank options.
